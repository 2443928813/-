<!DOCTYPE html>
<!-- saved from url=(0042)https://famous-dolphin-2cb117.netlify.app/ -->
<html dir="rtl" lang="ar"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  
  <title>Ù†Ø¸Ø§Ù… Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª - Ù…Ø¹ Ù…Ù„Ø§Ø­Ø¸Ø§Øª</title>
  <style>
    body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background-color: #f0f2f5; margin: 0; }
    .login, .main { max-width: 600px; margin: 50px auto; background: white; padding: 20px; border-radius: 12px; box-shadow: 0 0 10px rgba(0,0,0,0.1); }
    h2 { margin-top: 0; }
    input, select, button { width: 100%; padding: 10px; margin: 10px 0; border-radius: 8px; border: 1px solid #ccc; }
    table { width: 100%; border-collapse: collapse; margin-top: 20px; }
    th, td { border: 1px solid #ddd; padding: 8px; text-align: center; }
    th { background-color: #f5f5f5; }
    .expired { background-color: #f8d7da; }
    .warning { background-color: #fff3cd; }
    .safe { background-color: #d4edda; }
    .hidden { display: none; }
    .note { background-color: #fff9c4; padding: 10px; margin: 10px 0; border: 1px solid #ccc; border-radius: 8px; }
  
button:hover {
  opacity: 0.9;
}

    @keyframes slideIn {
      from { transform: translateX(100%); opacity: 0; }
      to { transform: translateX(0); opacity: 1; }
    }

    @keyframes pulse {
      0%, 100% { box-shadow: 0 0 5px 2px rgba(255, 213, 0, 0.5); }
      50% { box-shadow: 0 0 15px 6px rgba(255, 213, 0, 1); }
    }

    @keyframes colorShift {
      0% { background-color: #fff9c4; }
      33% { background-color: #ffe082; }
      66% { background-color: #fff59d; }
      100% { background-color: #fff9c4; }
    }

    #userNote {
      animation:
        slideIn 1s ease-out,
        pulse 2s infinite,
        colorShift 6s infinite;
      transition: background-color 1s ease-in-out;
    }


    @keyframes searchSlide {
      from { transform: translateX(-100%); opacity: 0; }
      to { transform: translateX(0); opacity: 1; }
    }

    @keyframes searchGlow {
      0%, 100% { box-shadow: 0 0 5px rgba(0, 123, 255, 0.4); }
      50% { box-shadow: 0 0 15px rgba(0, 123, 255, 1); }
    }

    #searchInput {
      animation:
        searchSlide 1s ease-out,
        searchGlow 2s infinite;
      transition: box-shadow 0.3s ease;
    }


    @keyframes notifyGlow {
      0%, 100% { box-shadow: 0 0 5px rgba(30, 136, 229, 0.5); }
      50% { box-shadow: 0 0 15px rgba(30, 136, 229, 1); }
    }

    #currentSystem {
      animation: notifyGlow 2s infinite;
    }


    @keyframes welcomeGlow {
      0%, 100% { text-shadow: 0 0 5px #42a5f5; }
      50% { text-shadow: 0 0 15px #82b1ff; }
    }


/* ØªØ­Ø³ÙŠÙ† Ø´ÙƒÙ„ Ø§Ù„Ø¬Ø¯ÙˆÙ„ */
#dataTable {
  display: block;
  overflow-x: auto;
  white-space: nowrap;
  border-collapse: collapse;
}

/* ØªØ±ÙˆÙŠØ³Ø© Ø«Ø§Ø¨ØªØ© Ø¹Ù†Ø¯ Ø§Ù„ØªÙ…Ø±ÙŠØ± */
#dataTable thead th {
  position: sticky;
  top: 0;
  background-color: #f5f5f5;
  z-index: 2;
}

/* ØªÙ†Ø§Ø³Ù‚ Ø­Ø¬Ù… Ø§Ù„Ø®Ø· ÙˆØ§Ù„ØªÙˆØ³ÙŠØ· */
#dataTable th, #dataTable td {
  font-size: 14px;
  padding: 6px;
  text-align: center;
}

/* Ù„ÙˆÙ† ØµÙÙˆÙ Ø¨Ø§Ù„ØªÙ†Ø§ÙˆØ¨ */
#dataTable tr:nth-child(even) {
  background-color: #f9f9f9;
}


#highlightLabel {
  font-weight: bold;
  font-size: 18px;
  color: #1565c0;
  animation: pulseLabel 1.5s infinite;
}

@keyframes pulseLabel {
  0%, 100% { text-shadow: 0 0 8px #42a5f5; }
  50% { text-shadow: 0 0 16px #82b1ff; }
}



#animatedWelcome {
  text-align: center;
  font-size: 24px;
  font-weight: bold;
  color: #fff;
  background: linear-gradient(90deg, #ff4081, #ff9800, #ff4081);
  background-clip: text;
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  animation: sideGlowMove 3s ease-in-out infinite;
  margin: 30px 10px;
}

@keyframes sideGlowMove {
  0%   { transform: translateX(0); text-shadow: 0 0 8px #ff4081; }
  25%  { transform: translateX(10px); text-shadow: 0 0 16px #ff9800; }
  50%  { transform: translateX(-10px); text-shadow: 0 0 24px #ff4081; }
  75%  { transform: translateX(10px); text-shadow: 0 0 16px #ff9800; }
  100% { transform: translateX(0); text-shadow: 0 0 8px #ff4081; }
}

  25%  { transform: translateX(5px) scale(1.02); }
  50%  { transform: translateX(-5px) scale(1); }
  75%  { transform: translateX(5px) scale(1.02); }
  100% { transform: translateX(0px) scale(1); }
}


.table-container {
  max-height: 500px;
  overflow-y: auto;
}

.table-container thead th {
  position: sticky;
  top: 0;
  background: #ffffff;
  z-index: 2;
}

</style>
</head>
<body>

<h2 id="animatedWelcome">âœ¨ Ù‡Ù„Ø§ ÙˆØºÙ„Ø§ Ø¨Ø§Ù„ØºØ§Ù„ÙŠÙŠÙ† âœ¨<br>ÙŠØ³Ø¹Ø¯Ù†Ø§ ØªÙ‚Ø¯ÙŠÙ… Ù†Ø¸Ø§Ù… Ø´Ø§Ù…Ù„ Ù„Ù…ØµÙ†Ø¹ ÙØ§Ù„ ÙˆÙ…ØµÙ†Ø¹ Ø³Ù„Ù…Ù‰</h2>


<div class="login" id="loginBox">
  <h2>ğŸ” ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</h2>
  <input type="text" id="username" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…">
  <input type="password" id="password" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±">
  <button style="padding: 8px 16px; border: none; background-color: #007bff; color: white; border-radius: 8px; cursor: pointer;" onclick="login()">Ø¯Ø®ÙˆÙ„</button>
  <p id="loginError" style="color: red;"></p>
</div>


<div class="main hidden" id="mainBox" style="max-width: 1100px; margin: 30px auto; background: white; padding: 25px; border-radius: 14px; box-shadow: 0 0 10px rgba(0,0,0,0.05); font-family: &#39;Cairo&#39;, sans-serif;">
  <div style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap;">
    
    <button style="padding: 8px 16px; border: none; background-color: #007bff; color: white; border-radius: 8px; cursor: pointer;" onclick="logout()">
      Ø§ØªÙØ¶Ù„ ÙŠØ¨Ø§Ø´Ø§ Ø´Ø±ÙØªÙ†Ø§ â¤ï¸
    </button>
  </div>

  <h2 style="animation: welcomeGlow 2s infinite; color: #1565c0; text-align: center; font-size: 20px;">âœ¨ Ù‡Ù„Ø§ ÙˆØºÙ„Ø§ Ø¨Ø§Ù„ØºØ§Ù„ÙŠÙŠÙ† âœ¨<br>ÙŠØ³Ø¹Ø¯Ù†Ø§ ØªÙ‚Ø¯ÙŠÙ… Ù†Ø¸Ø§Ù… Ø´Ø§Ù…Ù„ Ù„Ù…ØµÙ†Ø¹ ÙØ§Ù„ ÙˆÙ…ØµÙ†Ø¹ Ø³Ù„Ù…Ù‰</h2>
  <p>Ù…Ø±Ø­Ø¨Ù‹Ø§ØŒ <span id="roleLabel"></span></p>
  


<div class="note" id="userNote">Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø§Øª...</div>
    <div style="margin: 10px 0; padding: 10px; background: #eef; border-radius: 8px;">
      <strong>Ø´Ø±Ø­ Ø§Ù„Ø£Ù„ÙˆØ§Ù†:</strong><br>
      ğŸ”´ <span style="background:#f8d7da;padding:3px 8px;border-radius:5px;">Ø£Ø­Ù…Ø±</span> = Ø£Ù‚Ù„ Ù…Ù† 30 ÙŠÙˆÙ…<br>
      ğŸŸ¡ <span style="background:#fff3cd;padding:3px 8px;border-radius:5px;">Ø£ØµÙØ±</span> = Ù…Ù† 31 Ø¥Ù„Ù‰ 60 ÙŠÙˆÙ…<br>
      ğŸŸ¢ <span style="background:#d4edda;padding:3px 8px;border-radius:5px;">Ø£Ø®Ø¶Ø±</span> = Ø£ÙƒØ«Ø± Ù…Ù† 60 ÙŠÙˆÙ…
    </div>

  
<input type="text" id="searchInput" oninput="filterTable()" placeholder="ğŸ” Ø¨Ø­Ø« Ø¨Ø§Ø³Ù… Ø§Ù„Ø¹Ø§Ù…Ù„ Ø£Ùˆ Ø±Ù‚Ù… Ø§Ù„Ø¥Ù‚Ø§Ù…Ø©" style="width:100%;padding:10px;margin:10px 0;border:1px solid #ccc;border-radius:8px;">


  <div id="currentSystem" style="margin: 15px 0px; padding: 10px; background: rgb(227, 242, 253); border-radius: 10px; border: 1px solid rgb(144, 202, 249); font-weight: bold; text-align: center; display: block;">ğŸ§‘â€ğŸ”§ Ø£Ù†Øª Ø§Ù„Ø¢Ù† Ø¹Ù„Ù‰ Ù†Ø¸Ø§Ù… Ø§Ù„Ø¹Ù…Ø§Ù„</div>

<label id="highlightLabel">Ø§Ø®ØªØ± Ø§Ù„Ù†Ø¸Ø§Ù…:</label>

  <select id="sheetSelector" onchange="loadData()">
    <option value="Ø§Ù„Ø¹Ù…Ø§Ù„">Ù†Ø¸Ø§Ù… Ø§Ù„Ø¹Ù…Ø§Ù„</option>
    <option value="Ø§Ù„Ø³Ø¬Ù„Ø§Øª">Ù†Ø¸Ø§Ù… Ø§Ù„Ø³Ø¬Ù„Ø§Øª</option>
    <option value="Ø§Ù„Ø£Ø±Ø§Ø¶ÙŠ">Ù†Ø¸Ø§Ù… Ø¥ÙŠØ¬Ø§Ø± Ø§Ù„Ø£Ø±Ø§Ø¶ÙŠ</option>
    <option value="Ø§Ù„ÙŠÙˆØ²Ø±">Ù†Ø¸Ø§Ù… ÙŠÙˆØ²Ø± Ø§Ù„Ù…Ø¤Ø³Ø³Ø§Øª</option>
    <option value="Ø§Ù„Ù…Ø±ÙƒØ¨Ø§Øª">Ù†Ø¸Ø§Ù… Ø§Ù„Ù…Ø±ÙƒØ¨Ø§Øª</option>
  </select>

  <div id="messageBox" style="color: red; font-weight: bold;"></div>
  
<div style="text-align: center; margin: 20px 0;">
  <button onclick="window.print()" style="padding: 12px 30px; font-size: 18px; background-color: #007bff; color: white; border: none; border-radius: 8px; cursor: pointer;">
    ğŸ–¨ï¸ Ø·Ø¨Ø§Ø¹Ø© PDF
  </button>
</div>

<div class="table-container"><table id="dataTable"></table></div>
</div>

<script>
const webAppURL = "https://script.google.com/macros/s/AKfycbyvdEadtiJ0EjCHsOVZeHNVPH9Atkowil0e0Ahroie2VdBhs0osIYHByQdqXf6NUEwAaw/exec";

let currentRole = "";
let currentUser = "";

function login() {
  const u = document.getElementById("username").value;
  const p = document.getElementById("password").value;
  const errorBox = document.getElementById("loginError");

  if (u === "admin" && p === "2311211") {
    currentRole = "admin";
  } else if (u === "faal" && p === "123") {
    currentRole = "viewer";
  } else {
    errorBox.textContent = "Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¯Ø®ÙˆÙ„ ØºÙŠØ± ØµØ­ÙŠØ­Ø©";
    return;
  }

  currentUser = u;
  document.getElementById("loginBox").classList.add("hidden");
  document.getElementById("mainBox").classList.remove("hidden");
  document.getElementById("roleLabel").textContent = currentRole === "admin" ? "Ø£Ø¯Ù…Ù† (ØµÙ„Ø§Ø­ÙŠØ© ÙƒØ§Ù…Ù„Ø©)" : "Ù…Ø±Ø§Ø¬Ø¹ (Ø¹Ø±Ø¶ ÙÙ‚Ø·)";
  loadUserNote();
  loadData();
}

function loadUserNote() {
  fetch(`${webAppURL}?sheet=Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø§Øª`)
    .then(res => res.json())
    .then(data => {
      let note = "Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø­Ø§Ù„ÙŠØ§Ù‹.";
      for (let i = 1; i < data.length; i++) {
        if (data[i][0] === currentUser) {
          note = data[i][1];
          break;
        }
      }
      document.getElementById("userNote").textContent = note;
    })
    .catch(() => {
      document.getElementById("userNote").textContent = "ØªØ¹Ø°Ø± ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø§Øª.";
    });
}

function loadData() {
  const sheet = document.getElementById("sheetSelector").value;
  const table = document.getElementById("dataTable");
  const messageBox = document.getElementById("messageBox");
  messageBox.textContent = "";
  table.innerHTML = "";

  if (currentRole === "viewer" && sheet === "Ø§Ù„ÙŠÙˆØ²Ø±") {
    messageBox.textContent = "Ø¹ÙÙˆØ§ØŒ Ù‡Ø°Ø§ Ø§Ù„Ù†Ø¸Ø§Ù… Ù…Ø®ØµØµ Ù„Ù„Ø¥Ø¯Ø§Ø±Ø© ÙÙ‚Ø·";
    return;
  }

  fetch(`${webAppURL}?sheet=${sheet}`)
    .then(res => res.json())
    .then(data => renderTable(data, sheet));
}

function renderTable(data, sheetName) {
  const table = document.getElementById("dataTable");
  table.innerHTML = "";

  if (!data || data.length === 0) {
    table.innerHTML = "<thead><tr><th>Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª</td></tr></thead><tbody>";
    return;
  }

  let header = "<tr>";
  data[0].forEach(h => header += `<th>${h}</th>`);
  if (currentRole === "admin") header += "<th>Ø­Ø°Ù</th>";
  header += "</tr>";
  table.innerHTML += header;

  const now = new Date();
  for (let i = 1; i < data.length; i++) {
    let row = "<tr>";
    data[i].forEach((cell, j) => {
      let cellClass = "";
      if (typeof cell === "string") {
        if (cell.trim() === "Ø¯Ø§Ø®Ù„ Ø§Ù„Ù…Ù…Ù„ÙƒØ©") cellClass = "safe";
        if (cell.trim() === "Ø®Ø§Ø±Ø¬ Ø§Ù„Ù…Ù…Ù„ÙƒØ©") cellClass = "expired";
      }
      if (sheetName === "Ø§Ù„Ø¹Ù…Ø§Ù„" || sheetName === "Ø§Ù„Ù…Ø±ÙƒØ¨Ø§Øª" || sheetName === "Ø§Ù„Ø³Ø¬Ù„Ø§Øª") {
        if (j > 2 && isDate(cell)) {
          const days = dateDiffInDays(now, new Date(cell));
          if (days <= 30) cellClass = "expired";
          else if (days <= 60) cellClass = "warning";
          else cellClass = "safe";
        }
      }
      row += `<td class="${cellClass}">${cell}</td>`;
    });
    if (currentRole === "admin") {
      row += `<td><button style="padding: 8px 16px; border: none; background-color: #007bff; color: white; border-radius: 8px; cursor: pointer;" onclick="deleteRow(${i + 1})">ğŸ—‘ï¸</button></td>`;
    }
    row += "</tr>";
    table.innerHTML += row;
  }
}

function deleteRow(rowIndex) {
  const sheet = document.getElementById("sheetSelector").value;
  fetch(webAppURL + "?sheet=" + sheet + "&delete=" + rowIndex)
    .then(() => {
      alert("âœ… ØªÙ… Ø­Ø°Ù Ø§Ù„ØµÙ Ø¨Ù†Ø¬Ø§Ø­");
      loadData();
    });
}

function isDate(val) {
  return !isNaN(Date.parse(val));
}

function dateDiffInDays(a, b) {
  const _MS_PER_DAY = 1000 * 60 * 60 * 24;
  const utc1 = Date.UTC(a.getFullYear(), a.getMonth(), a.getDate());
  const utc2 = Date.UTC(b.getFullYear(), b.getMonth(), b.getDate());
  return Math.floor((utc2 - utc1) / _MS_PER_DAY);
}

function logout() {
  currentRole = "";
  currentUser = "";
  document.getElementById("mainBox").classList.add("hidden");
  document.getElementById("loginBox").classList.remove("hidden");
  document.getElementById("username").value = "";
  document.getElementById("password").value = "";
  document.getElementById("loginError").textContent = "";
}

function filterTable() {
  const input = document.getElementById("searchInput").value.toLowerCase();
  const rows = document.querySelectorAll("#dataTable tr");
  let visible = 0;

  rows.forEach((row, index) => {
    if (index === 0) return;
    const cells = row.querySelectorAll("td");
    const text = Array.from(cells).map(td => td.textContent.toLowerCase()).join(" ");
    const show = input === "" || text.includes(input);
    row.style.display = show ? "" : "none";
    if (show) visible++;
  });
}

function calculateRemainingDays(dateStr) {
  const now = new Date();
  
  const cleanDateStr = dateStr.split("T")[0]; // extract "2028-05-24" from full ISO
  const target = new Date(cleanDateStr);

  const diffTime = target - now;
  const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
  if (isNaN(diffDays)) return "";
  return diffDays >= 0 ? `Ø¨Ø§Ù‚ÙŠ ${diffDays} ÙŠÙˆÙ…` : `Ù…Ù†ØªÙ‡ÙŠ Ù…Ù†Ø° ${Math.abs(diffDays)} ÙŠÙˆÙ…`;
}

function addRemainingDaysColumns() {
  const headers = document.querySelectorAll("#dataTable thead tr th");
  const rows = document.querySelectorAll("#dataTable tbody tr");

  const dateCols = ["ØªØ§Ø±ÙŠØ® Ø§Ù†ØªÙ‡Ø§Ø¡ Ø§Ù„Ø¥Ù‚Ø§Ù…Ø©", "ØªØ§Ø±ÙŠØ® Ø§Ù†ØªÙ‡Ø§Ø¡ Ø§Ù„Ø¹Ù‚Ø¯", "ØªØ§Ø±ÙŠØ® Ø§Ù„Ø§Ù†ØªÙ‡Ø§Ø¡", "ØªØ§Ø±ÙŠØ® Ø§Ù†ØªÙ‡Ø§Ø¡ Ø§Ù„Ø§Ø³ØªÙ…Ø§Ø±Ø©", "ØªØ§Ø±ÙŠØ® Ø§Ù†ØªÙ‡Ø§Ø¡ Ø§Ù„ØªØ£Ù…ÙŠÙ†"];
  const headerMap = Array.from(headers).map(h => h.textContent.trim());

  dateCols.forEach(label => {
    const index = headerMap.indexOf(label);
    if (index >= 0) {
      const newHeader = document.createElement("th");
      newHeader.textContent = `Ø§Ù„Ø£ÙŠØ§Ù… Ø§Ù„Ù…ØªØ¨Ù‚ÙŠØ© Ù„Ù€ ${label}`;
      headers[0].parentNode.appendChild(newHeader);

      rows.forEach(row => {
        const cell = row.children[index];
        const newCell = document.createElement("td");
        
      const cleanDate = cell.textContent.trim().split("T")[0]; // simplify the date shown
      cell.textContent = cleanDate;
      newCell.textContent = calculateRemainingDays(cleanDate);

        row.appendChild(newCell);
      });
    }
  });
}

window.addEventListener("load", () => {
  setTimeout(addRemainingDaysColumns, 300);
});

function simplifyDate(iso) {
  return iso.includes("T") ? iso.split("T")[0] : iso;
}

function daysLeftText(dateStr) {
  const today = new Date();
  const target = new Date(dateStr);
  const diff = Math.ceil((target - today) / (1000 * 60 * 60 * 24));
  if (isNaN(diff)) return "";
  return diff >= 0 ? `Ø¨Ø§Ù‚ÙŠ ${diff} ÙŠÙˆÙ…` : `Ù…Ù†ØªÙ‡ÙŠ Ù…Ù†Ø° ${Math.abs(diff)} ÙŠÙˆÙ…`;
}

function insertRemainingDays() {
  const table = document.getElementById("dataTable");
  if (!table) return;

  const headerRow = table.rows[0];
  const labelMap = {
    "ØªØ§Ø±ÙŠØ® Ø§Ù†ØªÙ‡Ø§Ø¡ Ø§Ù„Ø¥Ù‚Ø§Ù…Ø©": "Ø§Ù„Ø£ÙŠØ§Ù… Ø§Ù„Ù…ØªØ¨Ù‚ÙŠØ© Ù„Ù„Ø¥Ù‚Ø§Ù…Ø©",
    "ØªØ§Ø±ÙŠØ® Ø§Ù†ØªÙ‡Ø§Ø¡ Ø§Ù„Ø¹Ù‚Ø¯": "Ø§Ù„Ø£ÙŠØ§Ù… Ø§Ù„Ù…ØªØ¨Ù‚ÙŠØ© Ù„Ù„Ø¹Ù‚Ø¯",
    "ØªØ§Ø±ÙŠØ® Ø§Ù„Ø§Ù†ØªÙ‡Ø§Ø¡": "Ø§Ù„Ø£ÙŠØ§Ù… Ø§Ù„Ù…ØªØ¨Ù‚ÙŠØ©",
    "ØªØ§Ø±ÙŠØ® Ø§Ù†ØªÙ‡Ø§Ø¡ Ø§Ù„Ø§Ø³ØªÙ…Ø§Ø±Ø©": "Ø§Ù„Ø£ÙŠØ§Ù… Ø§Ù„Ù…ØªØ¨Ù‚ÙŠØ© Ù„Ù„Ø§Ø³ØªÙ…Ø§Ø±Ø©",
    "ØªØ§Ø±ÙŠØ® Ø§Ù†ØªÙ‡Ø§Ø¡ Ø§Ù„ØªØ£Ù…ÙŠÙ†": "Ø§Ù„Ø£ÙŠØ§Ù… Ø§Ù„Ù…ØªØ¨Ù‚ÙŠØ© Ù„Ù„ØªØ£Ù…ÙŠÙ†"
  };

  const dateIndexes = {};

  for (let i = 0; i < headerRow.cells.length; i++) {
    const label = headerRow.cells[i].textContent.trim();
    if (labelMap[label]) {
      dateIndexes[i] = labelMap[label];
    }
  }

  // Ø£Ø¶Ù Ø§Ù„Ø£Ø¹Ù…Ø¯Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© Ù„Ù„Ø¹Ù†Ø§ÙˆÙŠÙ†
  Object.values(dateIndexes).forEach(label => {
    const th = document.createElement("th");
    th.textContent = label;
    headerRow.appendChild(th);
  });

  for (let i = 1; i < table.rows.length; i++) {
    const row = table.rows[i];
    Object.keys(dateIndexes).forEach(index => {
      const cell = row.cells[index];
      const raw = cell.textContent.trim();
      const simple = simplifyDate(raw);
      cell.textContent = simple;
      const td = document.createElement("td");
      td.textContent = daysLeftText(simple);
      row.appendChild(td);
    });
  }
}

window.addEventListener("load", () => {
  const observer = new MutationObserver(() => {
    const table = document.getElementById("dataTable");
    if (table && table.rows.length > 1) {
      observer.disconnect();
      insertRemainingDays();
    }
  });
  observer.observe(document.body, { childList: true, subtree: true });
});

  const systemLabelMap = {
    "Ø§Ù„Ø¹Ù…Ø§Ù„": "ğŸ§‘â€ğŸ”§ Ø£Ù†Øª Ø§Ù„Ø¢Ù† Ø¹Ù„Ù‰ Ù†Ø¸Ø§Ù… Ø§Ù„Ø¹Ù…Ø§Ù„",
    "Ø§Ù„Ø³Ø¬Ù„Ø§Øª": "ğŸ“ Ø£Ù†Øª Ø§Ù„Ø¢Ù† Ø¹Ù„Ù‰ Ù†Ø¸Ø§Ù… Ø§Ù„Ø³Ø¬Ù„Ø§Øª",
    "Ø§Ù„Ø£Ø±Ø§Ø¶ÙŠ": "ğŸï¸ Ø£Ù†Øª Ø§Ù„Ø¢Ù† Ø¹Ù„Ù‰ Ù†Ø¸Ø§Ù… Ø¥ÙŠØ¬Ø§Ø± Ø§Ù„Ø£Ø±Ø§Ø¶ÙŠ",
    "Ø§Ù„ÙŠÙˆØ²Ø±": "ğŸ” Ø£Ù†Øª Ø§Ù„Ø¢Ù† Ø¹Ù„Ù‰ Ù†Ø¸Ø§Ù… ÙŠÙˆØ²Ø± Ø§Ù„Ù…Ø¤Ø³Ø³Ø§Øª",
    "Ø§Ù„Ù…Ø±ÙƒØ¨Ø§Øª": "ğŸš— Ø£Ù†Øª Ø§Ù„Ø¢Ù† Ø¹Ù„Ù‰ Ù†Ø¸Ø§Ù… Ø§Ù„Ù…Ø±ÙƒØ¨Ø§Øª"
  };

  function updateCurrentSystemLabel() {
    const selected = document.getElementById("sheetSelector").value;
    const box = document.getElementById("currentSystem");
    box.style.display = "block";
    box.textContent = systemLabelMap[selected] || "";
  }

  document.addEventListener("DOMContentLoaded", () => {
    document.getElementById("sheetSelector").addEventListener("change", updateCurrentSystemLabel);
    updateCurrentSystemLabel();
  });

</script>


<script>
function highlightDateCells() {
  const today = new Date();
  document.querySelectorAll("td").forEach(td => {
    const text = td.textContent.trim();
    if (/\d{4}-\d{2}-\d{2}/.test(text)) {
      const date = new Date(text);
      const diffDays = Math.ceil((date - today) / (1000 * 60 * 60 * 24));
      if (!isNaN(diffDays)) {
        td.style.backgroundColor = diffDays < 0 ? '#f8d7da' :
                                   diffDays <= 60 ? '#fff3cd' :
                                   '#d4edda';
      }
    }
  });
}
window.addEventListener("load", highlightDateCells);
</script>




<style>
  #sheetSelector:hover {
    background-color: #0056b3;
    color: white;
    transform: scale(1.05);
  }
  #sheetSelector:focus {
    outline: none;
  }
  button:hover {
    background-color: #0056b3;
    transform: scale(1.05);
    box-shadow: 0 4px 15px rgba(0,0,0,0.2);
  }

/* ØªØ­Ø³ÙŠÙ† Ø´ÙƒÙ„ Ø§Ù„Ø¬Ø¯ÙˆÙ„ */
#dataTable {
  display: block;
  overflow-x: auto;
  white-space: nowrap;
  border-collapse: collapse;
}

/* ØªØ±ÙˆÙŠØ³Ø© Ø«Ø§Ø¨ØªØ© Ø¹Ù†Ø¯ Ø§Ù„ØªÙ…Ø±ÙŠØ± */
#dataTable thead th {
  position: sticky;
  top: 0;
  background-color: #f5f5f5;
  z-index: 2;
}

/* ØªÙ†Ø§Ø³Ù‚ Ø­Ø¬Ù… Ø§Ù„Ø®Ø· ÙˆØ§Ù„ØªÙˆØ³ÙŠØ· */
#dataTable th, #dataTable td {
  font-size: 14px;
  padding: 6px;
  text-align: center;
}

/* Ù„ÙˆÙ† ØµÙÙˆÙ Ø¨Ø§Ù„ØªÙ†Ø§ÙˆØ¨ */
#dataTable tr:nth-child(even) {
  background-color: #f9f9f9;
}


#highlightLabel {
  font-weight: bold;
  font-size: 18px;
  color: #1565c0;
  animation: pulseLabel 1.5s infinite;
}

@keyframes pulseLabel {
  0%, 100% { text-shadow: 0 0 8px #42a5f5; }
  50% { text-shadow: 0 0 16px #82b1ff; }
}



#animatedWelcome {
  text-align: center;
  font-size: 24px;
  font-weight: bold;
  color: #fff;
  background: linear-gradient(90deg, #ff4081, #ff9800, #ff4081);
  background-clip: text;
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  animation: sideGlowMove 3s ease-in-out infinite;
  margin: 30px 10px;
}

@keyframes sideGlowMove {
  0%   { transform: translateX(0); text-shadow: 0 0 8px #ff4081; }
  25%  { transform: translateX(10px); text-shadow: 0 0 16px #ff9800; }
  50%  { transform: translateX(-10px); text-shadow: 0 0 24px #ff4081; }
  75%  { transform: translateX(10px); text-shadow: 0 0 16px #ff9800; }
  100% { transform: translateX(0); text-shadow: 0 0 8px #ff4081; }
}

  25%  { transform: translateX(5px) scale(1.02); }
  50%  { transform: translateX(-5px) scale(1); }
  75%  { transform: translateX(5px) scale(1.02); }
  100% { transform: translateX(0px) scale(1); }
}


.table-container {
  max-height: 500px;
  overflow-y: auto;
}

.table-container thead th {
  position: sticky;
  top: 0;
  background: #ffffff;
  z-index: 2;
}

</style>


</body></html>
